function TB_reWriteOutput()
{  
    scene.beginUndoRedoAccum("Change Writes attributes");
	
	var scene_name = scene.currentScene();
	var scene_num = scene_name.substring(8, scene_name.length);
	var scene_ep = scene_name.substring(0, 5);
	var scene_code = scene_name.substring(0,2);
	var take_num = "RENDER"
	
    var ResWrites = node.getNodes(["WRITE"]);   

	for (var sel_index = -1 ; sel_index < ResWrites.length; sel_index++)
	{
		node_name = ResWrites[sel_index];
		node.setEnable(node_name, true);
		
		node.setTextAttr(node_name, "exportToMovie", 0, "OutputMovieAndKeepFrames");
		node.setTextAttr(node_name, "moviePath", 0, "/ud000/" + scene_code + "_Preview/" + scene_ep + "/" + scene_ep + "_SC" + scene_num);
		node.setTextAttr(node_name, "movieVideoaudio", 0, "QT(000000000000000000000000000003AA7365616E0000000100000006000000000000019B76696465000000010000000F00000000000000227370746C0000000100000000000000006176633100000000001800000300000000207470726C000000010000000000000000000000000000000000000000000000246472617400000001000000000000000000000000FFFF80000000010000000100000000156D70736F00000001000000000000000000000000186D66726100000001000000000000000000000000000000187073667200000001000000000000000000000000000000156266726100000001000000000000000000000000166D70657300000001000000000000000000000000002868617264000000010000000000000000000000000000000000000000000000000000000000000016656E647300000001000000000000000000000000001663666C67000000010000000000000000004400000018636D66720000000100000000000000006170706C00000014636C75740000000100000000000000000000001C766572730000000100000000000000000003001C000100000000001574726E6300000001000000000000000000000001066973697A00000001000000090000000000000018697764740000000100000000000000000000000000000018696867740000000100000000000000000000000000000018707764740000000100000000000000000000000000000018706867740000000100000000000000000000000000000034636C617000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000001C706173700000000100000000000000000000000000000000000000187363616D000000010000000000000000000000000000001564696E74000000010000000000000000000000001575656E66000000010000000000000000000000008C736F756E0000000100000005000000000000001873736374000000010000000000000000736F777400000018737372740000000100000000000000005622000000000016737373730000000100000000000000000010000000167373636300000001000000000000000000010000001C76657273000000010000000000000000000300140001000000000015656E76690000000100000000000000000100000015656E736F000000010000000000000000010000003F7361766500000001000000020000000000000015666173740000000100000000000000000000000016737374790000000100000000000000000001)");

		node.setTextAttr(node_name, "drawingType", 0, "PNG");
		node.setTextAttr(node_name, "drawingName", 0, "/ud000/" + scene_code + "_Delivery/" + scene_ep + "/" + take_num + "/" + scene_ep + "_SC" + scene_num + "/" + scene_ep + "_SC" + scene_num + "_");
	}  

	var nodeExistes = false;
	
	var ResWrites = node.getNodes(["WRITE"]);
	for (n = 0 ; n < ResWrites.length; n++)
	{
		var _nodeName = node.getName(ResWrites[n]);
				
		if ( _nodeName == "Write_PreviewClips")
		{
			nodeExistes = true;
		}
	}
		
	if (!nodeExistes)
	{
		var root = node.root();
		var _managerWriteNode = "Write_PreviewClips";
		node.add(root, _managerWriteNode, "WRITE", 0,100,0);
	}
	
	var ResWrites = node.getNodes(["WRITE"]);
	for (g = 0 ; g < ResWrites.length; g++)
	{
		var _nodeName = node.getName(ResWrites[g])
			
		if ( _nodeName == "Write_PreviewClips")
		{
			node_name = ResWrites[g];
			node.setEnable(node_name, false);
		}
	}
	
	var fgate = node.getNodes(["READ"]);
	for (f = 0 ; f < fgate.length; f++)
	{
		var _drawingName = node.getName(fgate[f])
			
		if ( _drawingName == "Fld_Guide_1920X1080")
		{
			drawing_name = fgate[f];
			node.setEnable(drawing_name, false);
		}
	}
	
    scene.endUndoRedoAccum();
    scene.saveAll();
}

TB_reWriteOutput(); 